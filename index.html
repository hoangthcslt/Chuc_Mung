<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>L·ªùi Nh·∫Øn ƒê·∫∑c Bi·ªát!</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Pacifico&display=swap" rel="stylesheet">
    
    <style>
        /* === C·∫§U H√åNH C∆† B·∫¢N === */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            background-color: #ffdde1;
            overflow: hidden;
            font-family: 'Pacifico', cursive;
            width: 100vw;
            height: 100vh;
        }

        /* === XOAY M√ÄN H√åNH TR√äN ƒêI·ªÜN THO·∫†I === */
        /* Logic: N·∫øu m√†n h√¨nh d·ªçc (Portrait), xoay to√†n b·ªô n·ªôi dung ch√≠nh 90 ƒë·ªô */
        @media screen and (orientation: portrait) and (max-width: 900px) {
            #main-wrapper {
                width: 100vh; height: 100vw;
                position: absolute; top: 50%; left: 50%;
                transform: translate(-50%, -50%) rotate(90deg);
                overflow: hidden;
            }
            .message-box p { font-size: clamp(1.8em, 5vh, 3em) !important; }
            
            /* Tinh ch·ªânh ·∫£nh khi xoay m√†n h√¨nh */
            #center-image-container img {
                max-height: 65vw !important; /* Gi·ªõi h·∫°n chi·ªÅu cao ƒë·ªÉ kh√¥ng b·ªã tr√†n */
                max-width: 80vh !important;
            }
        }
        @media screen and (orientation: landscape) {
            #main-wrapper { width: 100%; height: 100%; position: relative; }
        }

        /* === M√ÄN H√åNH CH·ªú === */
        #start-screen {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-color: #ffdde1; z-index: 100;
            display: flex; justify-content: center; align-items: center; flex-direction: column;
            transition: opacity 0.5s ease;
        }
        @keyframes heartbeat {
            0% { transform: scale(1); } 50% { transform: scale(1.1); } 100% { transform: scale(1); }
        }
        #start-button {
            padding: 15px 40px; font-family: 'Pacifico', cursive; font-size: 1.8em;
            color: white; background: linear-gradient(45deg, #ff69b4, #ff8da1);
            border: none; border-radius: 50px; cursor: pointer;
            box-shadow: 0 10px 25px rgba(255, 105, 180, 0.4);
            animation: heartbeat 1.5s infinite;
        }

        /* === ƒê·∫æM NG∆Ø·ª¢C === */
        #countdown-screen {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-color: #ffdde1; z-index: 99; display: none;
            justify-content: center; align-items: center; flex-direction: column;
        }
        #countdown-number {
            font-size: 8em; color: #ff69b4;
            text-shadow: 2px 2px 10px rgba(255, 255, 255, 0.8);
            animation: countPulse 1s infinite;
        }
        @keyframes countPulse {
            0% { transform: scale(0.5); opacity: 0; } 50% { transform: scale(1.2); opacity: 1; } 100% { transform: scale(1); opacity: 0; }
        }

        /* === MATRIX & TEXT === */
        #matrix-canvas {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            z-index: 1; transition: opacity 1.5s ease-out;
        }
        .content-container {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            display: flex; justify-content: center; align-items: center;
            z-index: 2; padding: 20px; pointer-events: none;
        }
        .message-box {
            width: 100%; text-align: center; color: white;
            text-shadow: 0 0 10px rgba(255, 255, 255, 0.8), 0 0 20px #ff0055;
        }
        .message-box p {
            font-size: clamp(2.2em, 6vw, 3.5em); margin-bottom: 20px;
            opacity: 0; transform: translateY(30px);
            transition: opacity 1s ease-out, transform 1s; display: none;
        }
        .message-box p.visible { display: block; animation: fadeInMove 1s forwards; }
        @keyframes fadeInMove { from { opacity: 0; transform: translateY(30px); } to { opacity: 1; transform: translateY(0); } }
        .fade-out { opacity: 0 !important; transition: opacity 2s; }

        /* === HOA BAY === */
        #flower-container {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            z-index: 3; pointer-events: none; overflow: hidden;
        }
        .flower-item {
            position: absolute; bottom: -100px;
            font-size: 2.5em; opacity: 0;
            animation: floatUp linear forwards;
            filter: drop-shadow(0 0 5px rgba(255,255,255,0.5));
        }
        @keyframes floatUp {
            0% { transform: translateY(0) rotate(0deg) scale(0.5); opacity: 0; }
            10% { opacity: 1; transform: scale(1); }
            100% { transform: translateY(-110vh) rotate(360deg) scale(1.2); opacity: 0; }
        }

        /* === ·∫¢NH TRUNG T√ÇM (ƒê∆Ø·ª¢C CH·ªàNH S·ª¨A) === */
        #center-image-container {
            position: absolute; 
            top: 50%; left: 50%; 
            transform: translate(-50%, -50%); /* CƒÉn ch√≠nh gi·ªØa m√†n h√¨nh */
            z-index: 4; /* N·∫±m tr√™n l·ªõp Matrix, d∆∞·ªõi l·ªõp ch·ªØ Happy Birthday */
            opacity: 0; /* ·∫®n m·∫∑c ƒë·ªãnh */
            transition: opacity 3s ease-in; /* Hi·ªán t·ª´ t·ª´ trong 3 gi√¢y */
            
            display: flex;
            justify-content: center;
            align-items: center;
            width: 100%;
            height: 100%;
            pointer-events: none;
        }

        #center-image-container img {
            max-width: 85%; /* Kh√¥ng bao gi·ªù r·ªông qu√° 85% m√†n h√¨nh */
            max-height: 70vh; /* Kh√¥ng bao gi·ªù cao qu√° 70% chi·ªÅu cao m√†n h√¨nh */
            width: auto;
            height: auto;
            
            border: 8px solid #fff; /* Vi·ªÅn tr·∫Øng gi·ªëng khung ·∫£nh polaroid */
            border-radius: 15px; /* Bo g√≥c nh·∫π */
            box-shadow: 0 10px 30px rgba(0,0,0,0.3), 0 0 20px rgba(255, 105, 180, 0.6); /* ƒê·ªï b√≥ng v√† ph√°t s√°ng nh·∫π */
            object-fit: contain; /* Gi·ªØ nguy√™n t·ªâ l·ªá ·∫£nh */
        }

        /* === L·ªúI CH√öC CU·ªêI === */
        #final-message-container {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            display: flex; justify-content: center; align-items: flex-end; /* CƒÉn xu·ªëng ƒë√°y */
            padding-bottom: 8%; /* C√°ch ƒë√°y m·ªôt kho·∫£ng */
            z-index: 5; opacity: 0;
            transition: opacity 2s ease-in; pointer-events: none;
        }
        
        #final-message h1 {
            font-size: clamp(2.5em, 8vw, 4.5em); color: #fff;
            text-shadow: 0 0 10px #ff1493, 0 0 20px #ff1493, 2px 2px 4px rgba(0,0,0,0.6);
            text-align: center;
            animation: pulseFinal 2s infinite ease-in-out;
        }
        @keyframes pulseFinal { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.05); } }

    </style>
</head>

<body>

    <div id="main-wrapper">
        <!-- N√∫t b·∫•m ban ƒë·∫ßu -->
        <div id="start-screen">
            <button id="start-button">‚ù§Ô∏è Nh·∫•n v√†o ƒë√¢y nh√©! ‚ù§Ô∏è</button>
        </div>

        <!-- M√†n h√¨nh ƒë·∫øm ng∆∞·ª£c -->
        <div id="countdown-screen">
            <div id="countdown-number">5</div>
            <p style="font-size: 1.5em; color: #ff69b4; margin-top: 20px;">Ch·ªù x√≠u nha...</p>
        </div>

        <audio id="background-music" loop preload="auto">
            <source src="nhac-nen.mp3" type="audio/mpeg"> 
        </audio>

        <canvas id="matrix-canvas"></canvas>

        <div class="content-container">
            <div class="message-box">
                <p>G·ª≠i ƒë·∫øn: Hoa Linh üå∑</p>
                <p>25/11/2025</p>
                <p>H√¥m nay l√† ng√†y ƒë·∫∑c bi·ªát c·ªßa bn... üéâ</p>
                <p>Ch√∫c bn m·ªôt ng√†y sinh nh·∫≠t vui v·∫ª ü©∑</p>
                <p>..V·∫≠y l√† c≈©ng ƒë√£ gia nh·∫≠p h·ªôi U30 r√≤i üíÜ‚Äç‚ôÇÔ∏è kkk..</p>
                <p>Ch√∫c bn tu·ªïi m·ªõi lu√¥n xinh ƒë·∫πp, y√™u ƒë·ªùi v√† t√≠ch c·ª±c nh√©!</p>
                <p>:>> may l√∫c n√£y m·ªõi c√≥ ·∫£nh b ƒë·ªÉ ho√†n thi·ªán file n√†y üòá m√† ·∫£nh ƒë·∫πp nha <3 </p>
                <p>p/s: C√≥ th·ªÉ file n√†y tui l√†m h∆°i g·∫•p n√™n ko th·ªÉ tr∆°n tru ƒë∆∞·ª£c 100% ƒë∆∞·ª£c, b th√¥ng c·∫£m nha üåπ</p>
                <p>‚ù§Ô∏è</p>
                <p style="font-size: 1.5em">T·ª´: p.a.n.d.a -  ï‚Ä¢·¥•‚Ä¢ î</p>
            </div>
        </div>

        <!-- Container ch·ª©a hoa bay (ch·ªâ c√≥ hoa) -->
        <div id="flower-container"></div>

        <!-- Container ch·ª©a ·∫¢NH ƒê·ª®NG Y√äN GI·ªÆA M√ÄN H√åNH -->
        <div id="center-image-container">
            <!-- ƒê·∫£m b·∫£o t√™n file ·∫£nh ch√≠nh x√°c l√† anh_nenn.jpg -->
            <img src="anh-nenn.jpg" alt="Birthday Photo">
        </div>

        <div id="final-message-container">
            <div id="final-message"><h1>..Happy Birthday ‚ù§Ô∏è</h1></div>
        </div>

    </div>

    <script>
        const startScreen = document.getElementById('start-screen');
        const startButton = document.getElementById('start-button');
        const countdownScreen = document.getElementById('countdown-screen');
        const countdownNumber = document.getElementById('countdown-number');
        const music = document.getElementById('background-music');
        const mainWrapper = document.getElementById('main-wrapper');

        // === 1. START & COUNTDOWN ===
        startButton.addEventListener('click', () => {
            startScreen.style.opacity = '0';
            setTimeout(() => { startScreen.style.display = 'none'; }, 500);
            countdownScreen.style.display = 'flex';
            music.play().catch(e => console.log("Audio play error"));

            let count = 5;
            const countInterval = setInterval(() => {
                count--;
                if (count > 0) {
                    countdownNumber.innerText = count;
                } else {
                    clearInterval(countInterval);
                    countdownScreen.style.display = 'none';
                    runVisualTimeline();
                }
            }, 1000);
        });

        // === 2. MATRIX ===
        const canvas = document.getElementById('matrix-canvas');
        const ctx = canvas.getContext('2d');
        function resizeCanvas() {
            canvas.width = mainWrapper.offsetWidth;
            canvas.height = mainWrapper.offsetHeight;
        }
        resizeCanvas();
        window.addEventListener('resize', resizeCanvas);

        const characters = '‚ù§';
        const fontSize = 20;
        let columns = Math.floor(canvas.width / fontSize);
        let drops = []; 
        function initMatrix() { columns = Math.floor(canvas.width / fontSize); drops = Array(columns).fill(1); }
        initMatrix();

        function drawMatrix() {
            ctx.fillStyle = 'rgba(255, 221, 225, 0.15)';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            ctx.fillStyle = '#ff5e99';
            ctx.font = `${fontSize}px Arial`;
            for (let i = 0; i < drops.length; i++) {
                ctx.fillText(characters, i * fontSize, drops[i] * fontSize);
                if (drops[i] * fontSize > canvas.height && Math.random() > 0.98) drops[i] = 0;
                drops[i]++;
            }
        }

        // === 3. HOA BAY (Ch·ªâ t·∫°o hoa, kh√¥ng t·∫°o ·∫£nh) ===
        const flowerContainer = document.getElementById('flower-container');
        const flowers = ['üå∏', 'üå∫', 'üå∑', 'üåª', 'üåº', 'üåπ', 'üíê']; 

        function createFlower() {
            const el = document.createElement('div');
            el.classList.add('flower-item');
            el.innerText = flowers[Math.floor(Math.random() * flowers.length)];
            el.style.left = `${Math.random() * 100}%`;
            // Random k√≠ch th∆∞·ªõc hoa m·ªôt ch√∫t cho t·ª± nhi√™n
            el.style.fontSize = `${Math.random() * 1.5 + 1.5}em`;
            const duration = Math.random() * 3 + 4; // 4s - 7s
            el.style.animationDuration = `${duration}s`;
            flowerContainer.appendChild(el);
            setTimeout(() => el.remove(), duration * 1000);
        }

        // === 4. TIMELINE CH√çNH ===
        function runVisualTimeline() {
            const matrixInterval = setInterval(drawMatrix, 50);
            const messages = document.querySelectorAll('.message-box p');
            const messageBox = document.querySelector('.message-box');
            const centerImageContainer = document.getElementById('center-image-container'); // Khung ·∫£nh
            const finalMessageContainer = document.getElementById('final-message-container');
            
            let currentTime = 0;
            const timePerLine = 2500; 

            // Ch·∫°y t·ª´ng d√≤ng text
            messages.forEach((p, index) => {
                setTimeout(() => {
                    if(index > 0) {
                        messages[index-1].style.display = 'none';
                        messages[index-1].classList.remove('visible');
                    }
                    if (index === messages.length - 1) {
                         messages[index-1].style.display = 'block'; 
                         messages[index-1].classList.add('visible');
                    }
                    p.classList.add('visible');
                }, currentTime);
                currentTime += timePerLine;
            });

            const totalTextTime = currentTime + 2000;

            // H·∫øt ch·ªØ -> M·ªù Matrix & Box ch·ªØ
            setTimeout(() => {
                messageBox.classList.add('fade-out');
                canvas.classList.add('fade-out');
                setTimeout(() => clearInterval(matrixInterval), 2000);
            }, totalTextTime);

            // GIAI ƒêO·∫†N CU·ªêI: Hi·ªán ·∫¢nh + Hoa bay + Ch·ªØ Happy Birthday
            setTimeout(() => {
                // 1. B·∫Øt ƒë·∫ßu t·∫°o hoa bay
                const flowerInterval = setInterval(createFlower, 200);
                
                // 2. Hi·ªán ·∫£nh trung t√¢m (ƒë·ª©ng y√™n, fade in)
                centerImageContainer.style.opacity = '1';

            }, totalTextTime - 1000); // B·∫Øt ƒë·∫ßu s·ªõm h∆°n ch√∫t khi ch·ªØ v·ª´a t·∫Øt

            // Hi·ªán ch·ªØ Happy Birthday sau khi ·∫£nh ƒë√£ hi·ªán r√µ m·ªôt ch√∫t
            setTimeout(() => {
                finalMessageContainer.style.opacity = '1';
            }, totalTextTime + 1500);
        }
    </script>
</body>
</html>
